---
version: '3'

tasks:
  ci:
    deps:
      - :install:python:pytest
      - :install:python:pytest-cov
      - :install:software:poetry
    cmds:
      - poetry config virtualenvs.create false
      - poetry install --no-dev
      - poetry run pytest --junitxml=report.xml --cov=src/
      - poetry run coverage report
      - poetry run coverage xml

  pytest:
    deps:
      - :install:python:requirements
    cmds:
      - poetry run pytest

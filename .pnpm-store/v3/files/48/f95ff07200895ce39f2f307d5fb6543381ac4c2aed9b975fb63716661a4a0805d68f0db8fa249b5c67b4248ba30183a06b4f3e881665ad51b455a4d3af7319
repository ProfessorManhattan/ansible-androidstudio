{"$schema":"http://json-schema.org/draft-07/schema","title":"Sourcehut Build Manifest","type":"object","properties":{"image":{"type":"string","examples":["archlinux","alpine/latest"]},"arch":{"type":"string","examples":["aarch64","x86_64"]},"packages":{"type":"array","items":{"type":"string"}},"repositories":{"type":"object","additionalProperties":{"type":"string"}},"artifacts":{"type":"array","items":{"type":"string"},"examples":["example/my-artifact.tar.gz"]},"shell":{"type":"boolean"},"sources":{"type":"array","items":{"type":"string","examples":["https://git.sr.ht/~sircmpwn/scdoc","https://git.sr.ht/~sircmpwn/scdoc#devel","git@git.sr.ht:~sircmpwn/scdoc","hg+https://hg.sr.ht/~sircmpwn/scdoc","hg+ssh://hg.sr.ht/~sircmpwn/scdoc"]}},"tasks":{"type":"array","minItems":1,"items":{"type":"object","additionalProperties":{"type":"string"},"propertyNames":{"pattern":"^[a-z0-9_-]{1,128}$"},"examples":[{"package":"cd $site\ntar -cvz . > ../site.tar.gz"}]}},"triggers":{"type":"array","items":{"type":"object","additionalProperties":true,"properties":{"action":{"type":"string","enum":["email","webhook"]},"condition":{"type":"string","enum":["always","failure","success"]}},"required":["action","condition"]}},"environment":{"type":"object","additionalProperties":{"type":"string"},"examples":[{"site":"your-username.srht.site"}]},"secrets":{"type":"array","items":{"type":"string","examples":["46f739e5-4538-45dd-a79f-bf173b7a2ed9"]}},"oauth":{"type":"string","examples":["pages.sr.ht/PAGES:RW"]}},"required":["image","tasks"]}
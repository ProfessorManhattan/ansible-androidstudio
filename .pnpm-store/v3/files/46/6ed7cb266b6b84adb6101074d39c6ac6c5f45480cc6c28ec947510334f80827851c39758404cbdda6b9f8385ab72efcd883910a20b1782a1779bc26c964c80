{"version":3,"sources":["align.js"],"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","defineProperty","exports","value","primitives_1","require","util_1","zeroWidth","start","tag","type","name","getWidth","w","tokens","delimiter","Markers","Math","max","space","len","padStart","align","intoTags","update","line","assign","isEmpty","description","end","delim","postDelimiter","nothingAfter","postName","postType","postTag","_a","source","fields","reduce","rewireSource","map","default"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst primitives_1 = require(\"../primitives\");\nconst util_1 = require(\"../util\");\nconst zeroWidth = {\n    start: 0,\n    tag: 0,\n    type: 0,\n    name: 0,\n};\nconst getWidth = (w, { tokens: t }) => ({\n    start: t.delimiter === primitives_1.Markers.start ? t.start.length : w.start,\n    tag: Math.max(w.tag, t.tag.length),\n    type: Math.max(w.type, t.type.length),\n    name: Math.max(w.name, t.name.length),\n});\nconst space = (len) => ''.padStart(len, ' ');\nfunction align() {\n    let intoTags = false;\n    let w;\n    function update(line) {\n        const tokens = Object.assign({}, line.tokens);\n        if (tokens.tag !== '')\n            intoTags = true;\n        const isEmpty = tokens.tag === '' &&\n            tokens.name === '' &&\n            tokens.type === '' &&\n            tokens.description === '';\n        // dangling '*/'\n        if (tokens.end === primitives_1.Markers.end && isEmpty) {\n            tokens.start = space(w.start + 1);\n            return Object.assign(Object.assign({}, line), { tokens });\n        }\n        switch (tokens.delimiter) {\n            case primitives_1.Markers.start:\n                tokens.start = space(w.start);\n                break;\n            case primitives_1.Markers.delim:\n                tokens.start = space(w.start + 1);\n                break;\n            default:\n                tokens.delimiter = '';\n                tokens.start = space(w.start + 2); // compensate delimiter\n        }\n        if (!intoTags) {\n            tokens.postDelimiter = tokens.description === '' ? '' : ' ';\n            return Object.assign(Object.assign({}, line), { tokens });\n        }\n        const nothingAfter = {\n            delim: false,\n            tag: false,\n            type: false,\n            name: false,\n        };\n        if (tokens.description === '') {\n            nothingAfter.name = true;\n            tokens.postName = '';\n            if (tokens.name === '') {\n                nothingAfter.type = true;\n                tokens.postType = '';\n                if (tokens.type === '') {\n                    nothingAfter.tag = true;\n                    tokens.postTag = '';\n                    if (tokens.tag === '') {\n                        nothingAfter.delim = true;\n                    }\n                }\n            }\n        }\n        tokens.postDelimiter = nothingAfter.delim ? '' : ' ';\n        if (!nothingAfter.tag)\n            tokens.postTag = space(w.tag - tokens.tag.length + 1);\n        if (!nothingAfter.type)\n            tokens.postType = space(w.type - tokens.type.length + 1);\n        if (!nothingAfter.name)\n            tokens.postName = space(w.name - tokens.name.length + 1);\n        return Object.assign(Object.assign({}, line), { tokens });\n    }\n    return (_a) => {\n        var { source } = _a, fields = __rest(_a, [\"source\"]);\n        w = source.reduce(getWidth, Object.assign({}, zeroWidth));\n        return util_1.rewireSource(Object.assign(Object.assign({}, fields), { source: source.map(update) }));\n    };\n}\nexports.default = align;\n"],"file":"align.cjs"}